{% extends 'base.html.twig' %}

{% block title %}Votre profile{% endblock %}

{% block body %}

    <h1>Profile</h1>
    <h2>Vos informations</h2>
    <div class="row">
        <div class="d-flex flex-column align-items-center">
            {% if user.getProfilePicture() is not empty %}
                <img src="{{ asset('uploads/images/profile_pictures/' ~ user.getProfilePicture()) }}" class="rounded-circle" alt="Profile picture" style="object-fit: contain" width="150px" height="150px" />
            {% else %}
                <img src="{{ asset('uploads/images/profile_pictures/default.jpg') }}" class="rounded-circle" alt="Profile picture" style="object-fit: contain" width="150px" height="150px"/>
            {% endif %}
            <div class="username">
                <p class="fw-bold">{{user.username}}</p>
            </div>
        </div>
        <div class="d-flex flex-row justify-content-around mt-4">
            <div class="prenom">
                <label for="prenom">Prenom:</label>
                {% if user.prenom is not empty %}
                    <p class="fw-bold">{{user.prenom}}</p>
                {% else %}
                    <p class="fw-bold">A préciser.</p>
                {% endif %}
            </div>
            <div class="nom">
                <label for="nom">Nom:</label>
                {% if user.nom is not empty %}
                    <p class="fw-bold">{{user.nom}}</p>
                {% else %}
                    <p class="fw-bold">A préciser.</p>
                {% endif %}
            </div>
        </div>
        <div class="d-flex flex-row justify-content-around mt-4">
            <div class="email">
                <label for="email">Email:</label>
                <p class="fw-bold">{{user.email}}</p>
            </div>
            <div class="email">
                <label for="email">Password:</label>
                <p class="fw-bold">**********</p>
            </div>
        </div>
        <a class="btn btn-primary" href={{ path('app_profile_edit') }}>Edit Profile</a>
    </div>
    <h2 class="mt-4">Vos commandes</h2>
    <div class="row">
        <table class="table table-stripped">
            <thead>
                <tr>
                    <th>Numéro de commande</th>
                    <th>Date de commande</th>
                    <th>Montant</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for commande in commandes %}
                    <tr>
                        <td>{{commande.id}}</td>
                        <td>{{commande.getDateAchat()|date('d/m/Y')}}</td>
                        <td> 
                            {% set totalAmount = 0 %}
                            {% for contenu in commande.getContenuPaniers() %}
                                {% set totalAmount = totalAmount + (contenu.produit.prix * contenu.quantite) %}
                            {% endfor  %}
                            {{ totalAmount }}
                        </td>
                        <td>
                            <a href="{{ path('app_panier_show', {'id': commande.id}) }}" class="btn btn-primary">Voir</a>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="6">
                            Vous n'avez pas de commandes.
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    


{% endblock %}

